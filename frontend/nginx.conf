server {
    listen 80;
    server_name localhost;

    root /usr/share/nginx/html;
    index index.html;

    # gzip config
    gzip on;
    gzip_min_length 1k;
    gzip_comp_level 9;
    gzip_types text/plain text/css text/javascript application/json application/javascript application/x-javascript application/xml;
    gzip_vary on;
    gzip_disable "MSIE [1-6]\.";

    location / {
        try_files $uri $uri/ /index.html;
    }

    # Proxy WebSocket to backend
    # Assuming the backend is reachable at the specified URL. 
    # In a real Docker setup, you might want to use an environment variable or a specific hostname.
    # For now, we will configure it to point to the host machine or a known backend IP if needed,
    # but typically this is handled by the browser contacting the same origin provided by Nginx.
    # If the user wants Nginx to proxy /ws to the backend, we need the backend address.
    # Given the user manually set the IP in agent.yaml, I will add a commented out example for proxying.
    
    location /ws {
         proxy_pass http://103.117.136.91:8080/ws;
         proxy_http_version 1.1;
         proxy_set_header Upgrade $http_upgrade;
         proxy_set_header Connection "Upgrade";
         proxy_set_header Host $host;
    }

    location /report {
         proxy_pass http://103.117.136.91:8080/report;
         proxy_set_header Host $host;
    }
}
